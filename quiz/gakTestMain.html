<!DOCTYPE HTML>

<html>
	<head>
		<title>투플+</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		
		<!-- Twoppl Style -->		
		<link rel="stylesheet" href="../assets/css/main.css" />
	
		
		<!-- Styles -->
		<link href="../assets/css/app.css" rel="stylesheet">
		<link href="../assets/css/mbti.css" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css2?family=Yeon+Sung&display=swap" rel="stylesheet">
		
		<style>
			#header{padding-top: 20px;}
			.inner{height: 10px;}
		</style>

	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner align-center">

							<!-- Logo -->
								<a href="../index.html" class="logo">
									<span><img src="../images/logo_250.png" alt="" style="width: 100px"/></span>
								</a>
						</div>
					</header>

				<!-- Main -->
					
				
				<div class="mbti-container">
					<div class="mbti-question">Q1. 당신의 키는?</div>
					<div class="mbti-answer a1">~168cm</div>
					<div class="mbti-answer a2">169~173cm</div>
					<div class="mbti-answer a3">174~177cm</div>
					<div class="mbti-answer a4">178cm~</div>
					<div class="pagi">
				<div class="page">
					1/15
				</div>
					
					
				<div class="pb">
					<div class="progress-inner"></div>
        		</div>
							
			</div>
									
			
			</div>
		</div>
				

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>
		
			<script>
				let progressBar = $(".progress-inner");
				progressBar.css("width", `${100/15}%`);

				let questions = [
					{"q1": "당신의 키는?", 
					 "a1": "~168cm", "a2": "169~173cm", "a3": "174~177cm", "a4" : "178cm~",
					 "aw1": "1", "aw2": "2", "aw3": "3", "aw4": "4"},
						
					{"q1": "당신의 몸무게는?", 
					 "a1": "~55kg", "a2": "56~72kg", "a3": "73~86kg", "a4" : "87kg~",
					 "aw1": "S", "aw2": "N", "aw3": "N", "aw4": "F"},


					{"q1": "벤치프레스 1회 최대 무게는?", 
					 "a1": "~40kg", "a2": "40~60kg", "a3": "60~100kg", "a4" : "100kg~",
					 "aw1": 30, "aw2": 50, "aw3": 80, "aw4": 120},
						
					{"q1": "데드리프트 1회 최대 무게는?", 
					 "a1": "~60kg", "a2": "60~90kg", "a3": "90~130kg", "a4" : "130kg~",
					 "aw1": 40, "aw2": 75, "aw3": 110, "aw4": 150},
						
					{"q1": "스쿼트 1회 최대 무게는?", 
					 "a1": "~60kg", "a2": "60~90kg", "a3": "90~130kg", "a4" : "130kg~",
					 "aw1": 40, "aw2": 75, "aw3": 110, "aw4": 150},
						

							
					{"q1": "일주일에 헬스장 가는 횟수는?", 
					 "a1": "주 0~3회", "a2": "주 4회 이상", 
					 "a1_mbti": "N", "a2_mbti": "E"},
						
					{"q1": "집에 있는 홈트레이닝 기구는 주로", 
					 "a1": "아령, 턱걸이, 바벨, 푸쉬업바", "a2": "줄넘기, 악력기, 훌라우프", 
					 "a1_mbti": "E", "a2_mbti": "N"},
						
					{"q1": "야 오랜만인데 한잔하자!", 
					 "a1": "그래 오늘 한잔 꺽자", "a2": "꺼져라 내친구는 아령이다", 
					 "a1_mbti": "N", "a2_mbti": "E"},
						
					{"q1": "오빠.. 미안한데 오늘 운동 안가면 안될까?", 
					 "a1": "남자가 쇠질하러 가는데 어디", "a2": "그래~ 운동이야 다음에 하면 돼", 
					 "a1_mbti": "E", "a2_mbti": "N"},
						
					{"q1": "아놀드가 우리 헬스장 트레이너로 왔는데 회당 15만원이다", 
					 "a1": "너무 비싸다", "a2": "인생 기회다", 
					 "a1_mbti": "N", "a2_mbti": "E"},	
						
					
						
					{"q1": "후인하강을 안다", 
					 "a1": "안다", "a2": "모른다", 
					 "a1_mbti": "C", "a2_mbti": "S"},
						
					{"q1": "지금 냉동실을 열어봐라. 닭가슴살이", 
					 "a1": "없다", "a2": "있다", 
					 "a1_mbti": "S", "a2_mbti": "C"},
						
					{"q1": "박재범 몸 6개월이면 만든다", 
					 "a1": "아니다", "a2": "맞다", 
					 "a1_mbti": "S", "a2_mbti": "C"},
						
					{"q1": "구독하고 있는 운동 유튜버가 있다", 
					 "a1": "있다", "a2": "없다", 
					 "a1_mbti": "C", "a2_mbti": "S"},
						
					{"q1": "어깨 근육은 크게 몇부분으로 되어있나?", 
					 "a1": "5부분", "a2": "3부분", 
					 "a1_mbti": "S", "a2_mbti": "C"},						
				];

				let height;
				let weight = {};
				let muscle = 0;
				let result = {};
				let questionProgress = 1;

				
				function get_result(){
					
					let newMuscle;
					let bmi;
					let character;
					
					// mbti 계산
					function filterItems(arr) { // 배열내 값이 3 이상인 것 만 필터링하는 함수
						return Object.keys(arr).filter(el => arr[el] >= 3);
					}
					let mbti = filterItems(result).join("");
					let newMbti;

					if(mbti == "EC" || mbti == "CE" ){ newMbti = "EC"; }
					else if(mbti == "ES" || mbti == "SE" ){ newMbti = "ES"; }
					else if(mbti == "NC" || mbti == "CN" ){ newMbti = "NC"; }
					else if(mbti == "NS" || mbti == "SN" ){ newMbti = "NS"; }
					console.log("mbti : " + mbti)
					
					// BMI 계산 weight, muscle 로 계산
					console.log("muscle : " + muscle);
					if(muscle < 170){ newMuscle = "A"; }
					else if(170 <= muscle && muscle < 260){	newMuscle = "B"; }
					else if(260 <= muscle && muscle < 360){	newMuscle = "C"; }
					else{ newMuscle = "D"; }
					console.log("newMuscle : " + newMuscle);
					
					
					console.log("weight : " + weight);
					if(weight == "skinny"){
						switch( newMuscle ){
							case 'A': bmi = 'M'; break;
							case 'B': bmi = 'L'; break;
							case 'C': bmi = 'H'; break;
							case 'D': bmi = 'H'; break;
						}
						
					}else if(weight == "normal"){
						switch( newMuscle ){
							case 'A': bmi = 'M'; break;
							case 'B': bmi = 'L'; break;
							case 'C': bmi = 'L'; break;
							case 'D': bmi = 'H'; break;
						}
					}else{
						switch( newMuscle ){
							case 'A': bmi = 'P'; break;
							case 'B': bmi = 'P'; break;
							case 'C': bmi = 'L'; break;
							case 'D': bmi = 'H'; break;
						}
					}
						
					console.log("after bmi : "  + bmi);
					
					// 최종 케릭터 결정
					character = bmi+mbti;
					console.log("fianl character : " + character);
					
					//location.href = `/mbti/${character}`;
					location.href = `/aimaim/quiz/gakTestResult.html`;

					return;
				}
				
				
				function shape_progress( ){
					//console.log(questionProgress);

					questionProgress += 1;
					if(questionProgress == 16){
						get_result();
						return;
					}
					
					q = questions[questionProgress-1];
					progressBar.css("width", `${100/15*questionProgress}%`);
					$(".page").text(`${questionProgress}/15`);

					$(".mbti-question").text(`Q${questionProgress}.${q["q1"]}`);					
					$(".a1").text(`${q["a1"]}`);
					$(".a2").text(`${q["a2"]}`);
					$(".a3").text(`${q["a3"]}`);	
					$(".a4").text(`${q["a4"]}`);	

					if(questionProgress >= 6){
						$(".a3").css("display", "none");
						$(".a4").css("display", "none");
					}
						
					
				}
				

				$(".mbti-answer").on("click", function() {
					let q = questions[questionProgress-1];				
					
					if (questionProgress == 1 ){ // 키
						shape_progress( );
						
					} else if (questionProgress == 2){ // 무게
						
						if ($(this).hasClass("a1")){ 
							weight = "skinny"; 
						} 
						else if ($(this).hasClass("a4")){ 
							weight = "fat"; 
						}
						else { 
							weight = "normal"; 
						}
						console.log("weight : " + weight);
						shape_progress( );
						
					} else if(3 <= questionProgress && questionProgress < 6){ // 벤치 & 데드 & 스쿼트
						
						if ($(this).hasClass("a1")){ 
							muscle += q["aw1"];
							
						} else if ($(this).hasClass("a2")){ 
							muscle += q["aw2"];
							
						} else if ($(this).hasClass("a3")){
							muscle += q["aw3"];
							
						} else{
							muscle += q["aw4"];
							
						}
						
						console.log("muscle : " + muscle);
						shape_progress( );
							  
					} else if(6 <= questionProgress && questionProgress <= 15) { // 유형 
						
						if ($(this).hasClass("a1")) 
						{
							if (q["a1_mbti"] in result) { 
								result[q["a1_mbti"]] += 1;
							} else {
								result[q["a1_mbti"]] = 1; 
							}
						} else { 
							if (q["a2_mbti"] in result) { 
								result[q["a2_mbti"]] += 1;
							} else {
								result[q["a2_mbti"]] = 1; 
							}
						}	
						console.log(result);
						shape_progress( );
						
					}
					

					
				});
			</script>
				

	</body>
</html>